<!DOCTYPE html>
<html lang="en">
<head>
  <title>VR Scene</title>
  <meta charset="utf-8">
  <script src="https://aframe.io/releases/1.7.1/aframe.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/c-frame/aframe-extras@7.6.1/dist/aframe-extras.min.js"></script>
  <script src="https://unpkg.com/aframe-environment-component@1.5.0/dist/aframe-environment-component.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/davidlab20/TFG@v0.7.1/docs/scripts/main.min.js"></script>
	<script>
		// Components registered
		AFRAME.registerComponent('show-on-enter-ar', {
				init: function () {
						const el = this.el;
						const scene = el.sceneEl;

						el.object3D.visible = false;  // Not visible by default

						this.updateVisibility = () => {
								el.object3D.visible = scene.is('ar-mode');
						};

						scene.addEventListener('enter-vr', this.updateVisibility);
						scene.addEventListener('exit-vr', this.updateVisibility);

						this.updateVisibility();
				},

				remove: function () {
						const scene = this.el.sceneEl;
						scene.removeEventListener('enter-vr', this.updateVisibility);
						scene.removeEventListener('exit-vr', this.updateVisibility);
				}
		});
	</script>
</head>
<body>
  <a-scene cursor="rayOrigin: mouse" raycaster="objects: [data-raycastable]" xr-mode-ui="XRMode: xr"
           webxr="optionalFeatures: hit-test, local-floor" ar-hit-test="target: #charts;">
    <a-entity id="user" movement-controls="speed: 0.1">

      <!-- Camera -->
      <a-camera id="camera" position="0 1.6 0" active="true" wasd-controls="acceleration: 35"></a-camera>

      <!-- VR controllers -->
      <a-entity laser-controls="hand: right" raycaster="objects: [data-raycastable]"
                line="color: yellow; opacity: 0.8">
      </a-entity>

      <a-entity laser-controls="hand: left" raycaster="objects: [data-raycastable]"
                line="color: yellow; opacity: 0.8">
      </a-entity>
    </a-entity>

    <!-- HUD -->
    <a-entity id="HUD" visible="false">
      <a-plane height="1" width="2" shader="flat" color="grey"></a-plane>
      <a-text id="HUD-text" align="center"></a-text>
    </a-entity>

    <!-- Environment -->
    <a-entity environment="preset: default" hide-on-enter-ar></a-entity>
    <a-light type="ambient" intensity="1.2" color="#ffffff" show-on-enter-ar></a-light>
    <a-light type="directional" intensity="0.8" position="1 2 1" show-on-enter-ar></a-light>

    <!-- Elements -->
    <a-entity id="charts">
      <a-entity position="0.0 2.0 -4.0" rotation="0.0 0.0 0.0">  <!-- Chart's box (modify this values if you want to change position or rotation) -->
			<a-entity position="-2.0 -2.0 1.0">
				<a-box info="gasoline : 35" position="0.6667 1.8919 -1.0" width="1.3333333333333333" height="3.7838" depth="2.0" color="blue" activates-param="param1__gasoline" data-raycastable></a-box>
				<a-box info="diesel : 30" position="2.0 1.6216 -1.0" width="1.3333333333333333" height="3.2432" depth="2.0" color="yellow" activates-param="param1__diesel" data-raycastable></a-box>
				<a-box info="electric : 37" position="3.3333 2.0 -1.0" width="1.3333333333333333" height="4.0" depth="2.0" color="green" activates-param="param1__electric" data-raycastable></a-box>

				<!-- X-axis -->
				<a-entity line="start: 0 0 0; end: 4 0 0; color: black"></a-entity>
				<a-text position="0.6667 0.01 0.5" rotation="-90 0 -90" value="gasoline" align="left"></a-text>
				<a-text position="2.0 0.01 0.5" rotation="-90 0 -90" value="diesel" align="left"></a-text>
				<a-text position="3.3333 0.01 0.5" rotation="-90 0 -90" value="electric" align="left"></a-text>

				<!-- Y-axis -->
				<a-entity line="start: 0 0 0; end: 0 4 0; color: black"></a-entity>
				<a-text position="-0.5 0.25 0" rotation="0 0 0" value="0.0" align="right"></a-text>
				<a-text position="-0.5 1.1875 0" rotation="0 0 0" value="9.25" align="right"></a-text>
				<a-text position="-0.5 2.125 0" rotation="0 0 0" value="18.5" align="right"></a-text>
				<a-text position="-0.5 3.0625 0" rotation="0 0 0" value="27.75" align="right"></a-text>
				<a-text position="-0.5 4.0 0" rotation="0 0 0" value="37.0" align="right"></a-text>
			</a-entity>
		</a-entity>
		
    </a-entity>
  </a-scene>
</body>
</html>